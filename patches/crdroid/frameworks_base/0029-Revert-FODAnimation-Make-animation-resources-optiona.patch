From b1e1e9231c2923bd33ff42dcdbf0ac897de9fb11 Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Wed, 30 Sep 2020 01:40:47 -0400
Subject: [PATCH 29/57] Revert "FODAnimation: Make animation resources optional
 [1/2]"

This reverts commit a13daddac20d78c952719325480f61ae29392774.
---
 packages/SystemUI/res/values/cr_arrays.xml    |  3 --
 .../systemui/biometrics/FODAnimation.java     | 33 ++++++++++++-------
 2 files changed, 21 insertions(+), 15 deletions(-)

diff --git a/packages/SystemUI/res/values/cr_arrays.xml b/packages/SystemUI/res/values/cr_arrays.xml
index d1fccc76bf1..71859080caf 100644
--- a/packages/SystemUI/res/values/cr_arrays.xml
+++ b/packages/SystemUI/res/values/cr_arrays.xml
@@ -28,9 +28,6 @@
         <item>@string/quick_settings_compass_NW</item> <!-- North west -->
     </string-array>
 
-    <integer-array name="fod_animation_resources">
-    </integer-array>
-
     <string-array name="type_clock_hours">
         <item>@string/text_clock_h_twelve</item>
         <item>@string/text_clock_h_one</item>
diff --git a/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java b/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java
index ce89dc6ff61..9d403a3f8c0 100644
--- a/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java
+++ b/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java
@@ -18,7 +18,6 @@ package com.android.systemui.biometrics;
 
 import android.content.Context;
 import android.content.res.Resources;
-import android.content.res.TypedArray;
 import android.graphics.drawable.AnimationDrawable;
 import android.graphics.PixelFormat;
 import android.provider.Settings;
@@ -43,8 +42,23 @@ public class FODAnimation extends ImageView {
     private boolean mIsKeyguard;
 
     private int mSelectedAnim;
-    private TypedArray mAnimationStyles;
-    private int mAnimationStylesCount;
+    private final int[] ANIMATION_STYLES = {
+        R.drawable.fod_miui_normal_recognizing_anim,
+        R.drawable.fod_miui_aod_recognizing_anim,
+        R.drawable.fod_miui_light_recognizing_anim,
+        R.drawable.fod_miui_pop_recognizing_anim,
+        R.drawable.fod_miui_pulse_recognizing_anim,
+        R.drawable.fod_miui_pulse_recognizing_white_anim,
+        R.drawable.fod_miui_rhythm_recognizing_anim,
+        R.drawable.fod_op_cosmos_recognizing_anim,
+        R.drawable.fod_op_mclaren_recognizing_anim,
+        R.drawable.fod_op_stripe_recognizing_anim,
+        R.drawable.fod_op_wave_recognizing_anim,
+        R.drawable.fod_pureview_dna_recognizing_anim,
+        R.drawable.fod_pureview_future_recognizing_anim,
+        R.drawable.fod_pureview_halo_ring_recognizing_anim,
+        R.drawable.fod_pureview_molecular_recognizing_anim
+    };
 
     public FODAnimation(Context context, int mPositionX, int mPositionY) {
         super(context);
@@ -69,15 +83,10 @@ public class FODAnimation extends ImageView {
     }
 
     public void update() {
-        mAnimationStyles = mContext.getResources().obtainTypedArray(R.array.fod_animation_resources);
-        mAnimationStylesCount = mAnimationStyles.length();
-        if (mAnimationStylesCount > 0) {
-            mSelectedAnim = Settings.System.getInt(mContext.getContentResolver(),
-                    Settings.System.FOD_ANIM, 0);
-            setBackgroundResource(mAnimationStyles.getResourceId(mSelectedAnim, -1));
-        } else {
-            setBackgroundResource(R.drawable.fod_miui_pulse_recognizing_white_anim);
-        }
+        mSelectedAnim = Settings.System.getInt(mContext.getContentResolver(),
+                Settings.System.FOD_ANIM, 0);
+
+        setBackgroundResource(ANIMATION_STYLES[mSelectedAnim]);
         recognizingAnim = (AnimationDrawable) getBackground();
     }
 
-- 
2.17.1

