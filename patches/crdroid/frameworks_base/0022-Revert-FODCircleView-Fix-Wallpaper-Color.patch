From 431db15d96925f083b5fabd44624ed53784fbf9e Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Wed, 30 Sep 2020 01:39:44 -0400
Subject: [PATCH 22/57] Revert "FODCircleView: Fix Wallpaper Color"

This reverts commit 812a30fd5f6f9b69953455a92ca1896ee11685ab.
---
 .../systemui/biometrics/FODCircleView.java    | 20 +++++--------------
 1 file changed, 5 insertions(+), 15 deletions(-)

diff --git a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
index e6c9d9ff3d0..e49588b5c4a 100644
--- a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
+++ b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
@@ -26,14 +26,12 @@ import android.content.res.Resources;
 import android.content.res.TypedArray;
 import android.database.ContentObserver;
 import android.graphics.Bitmap;
-import android.graphics.BitmapFactory;
 import android.graphics.Canvas;
 import android.graphics.Color;
 import android.graphics.Paint;
 import android.graphics.PixelFormat;
 import android.graphics.Point;
 import android.graphics.PorterDuff;
-import android.graphics.PorterDuffColorFilter;
 import android.graphics.PorterDuffXfermode;
 import android.hardware.biometrics.BiometricSourceType;
 import android.graphics.drawable.AnimationDrawable;
@@ -103,15 +101,12 @@ public class FODCircleView extends ImageView implements ConfigurationListener, T
     private final boolean mShouldBoostBrightness;
     private final Paint mPaintFingerprintBackground = new Paint();
     private final Paint mPaintFingerprint = new Paint();
-    private final Paint mPaintIcon = new Paint();
     private final WindowManager.LayoutParams mParams = new WindowManager.LayoutParams();
     private final WindowManager.LayoutParams mPressedParams = new WindowManager.LayoutParams();
     private final WindowManager mWindowManager;
 
     private IFingerprintInscreen mFingerprintInscreenDaemon;
 
-    private Bitmap mIconBitmap;
-
     private int mDreamingOffsetY;
 
     private int mCurrentBrightness;
@@ -513,6 +508,9 @@ public class FODCircleView extends ImageView implements ConfigurationListener, T
         mIsCircleShowing = false;
 
         setFODIcon();
+        mIconStyles = mContext.getResources().obtainTypedArray(R.array.fod_icon_resources);
+        setImageResource(mIconStyles.getResourceId(mSelectedIcon, -1));
+
         updateIconDim();
         invalidate();
 
@@ -539,21 +537,13 @@ public class FODCircleView extends ImageView implements ConfigurationListener, T
                     if (iconcolor != wallColor) {
                         iconcolor = wallColor;
                     }
-                    mIconStyles = mContext.getResources().obtainTypedArray(R.array.fod_icon_resources);
-                    mIconBitmap = BitmapFactory.decodeResource(getResources(),
-                            mIconStyles.getResourceId(mSelectedIcon, -1)).copy(Bitmap.Config.ARGB_8888, true);
-                    mPaintIcon.setColorFilter(new PorterDuffColorFilter(lighter(iconcolor, 3),
-                            PorterDuff.Mode.SRC_IN));
-                    Canvas canvas = new Canvas(mIconBitmap);
-                    canvas.drawBitmap(mIconBitmap, 0, 0, mPaintIcon);
-                    setImageBitmap(mIconBitmap);
+                    this.setColorFilter(lighter(iconcolor, 3));
                 }
             } catch (Exception e) {
                 // Nothing to do
             }
         } else {
-            mIconStyles = mContext.getResources().obtainTypedArray(R.array.fod_icon_resources);
-            setImageResource(mIconStyles.getResourceId(mSelectedIcon, -1));
+            this.setColorFilter(null);
         }
     }
 
-- 
2.17.1

